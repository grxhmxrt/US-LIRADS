<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LI-RADS Ultrasound Report Template</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Roboto',sans-serif;margin:0;padding:20px;background:linear-gradient(135deg,#e6f0fa,#f7f9fc);display:flex;justify-content:center;align-items:center;min-height:100vh}
        .container{background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,0.1);max-width:600px;width:100%}
        h1{text-align:center;color:#2c3e50;margin-bottom:20px;font-weight:700}
        table{width:100%;border-collapse:collapse;margin-bottom:20px}
        th,td{border:1px solid #e0e0e0;padding:12px;text-align:left}
        th{background:#3498db;color:#fff;font-weight:700}
        tr:nth-child(even){background:#f8f9fa}
        .button-container{display:flex;justify-content:center;gap:20px;margin-bottom:20px}
        button{padding:12px 24px;background:#3498db;color:#fff;border:none;border-radius:25px;cursor:pointer;font-size:16px;font-weight:700;transition:background .3s,transform .2s}
        button:hover{background:#2980b9;transform:translateY(-2px)}
        input,select{width:100%;padding:8px;border:1px solid #d1d5db;border-radius:5px;font-size:14px;background:#fff;transition:border-color .3s;box-sizing:border-box}
        input:focus,select:focus{outline:none;border-color:#3498db;box-shadow:0 0 5px rgba(52,152,219,0.3)}
        .lirads-reference{text-align:center;font-size:14px;color:#2c3e50;margin-bottom:20px}
        .copyright{text-align:center;font-size:12px;color:#666;margin-top:20px}
        #managementOutput{color:#c0392b;font-weight:600}
        #managementOutput em{font-style:italic;font-weight:normal;color:#555}
    </style>
</head>
<body onload="resetForm()">
<div class="container">
    <h1>LI-RADS Ultrasound Report Template</h1>
    <div class="button-container">
        <button type="button" onclick="resetForm()">Reset Form</button>
        <button type="button" onclick="copyReport()">Copy Report</button>
    </div>
    <div class="lirads-reference">Based on LI-RADS® Ultrasound Surveillance v2024 Core</div>
    <table>
        <tr><th>Finding</th><th>Details</th></tr>
        <tr><td>Date of Previous USS</td><td><input type="date" id="date"></td></tr>
        <tr><td>Liver Parenchymal Description</td><td><select id="liverDesc">
            <option value="">Select...</option>
            <option value="Normal">Normal</option>
            <option value="Steatosis Grade I">Steatosis Grade I</option>
            <option value="Steatosis Grade II">Steatosis Grade II</option>
            <option value="Steatosis Grade III">Steatosis Grade III</option>
            <option value="Coarse">Coarse</option>
            <option value="Lobulated Contour">Lobulated Contour</option>
        </select></td></tr>
        <tr><td>Portal Vein Patent</td><td><select id="portalVein"><option value="">Select...</option><option value="Yes">Yes</option><option value="No">No</option><option value="Unable to assess">Unable to assess</option></select></td></tr>
        <tr><td>PV Velocity (cm/s)</td><td><input type="text" id="pvVelocity"></td></tr>
        <tr><td>Hepatic Veins Patent</td><td><select id="hepaticVeins"><option value="">Select...</option><option value="Yes">Yes</option><option value="No">No</option><option value="Unable to assess">Unable to assess</option></select></td></tr>
        <tr><td>Recanalisation of Para-Umbilical Vein</td><td><select id="paraUmbilical"><option value="">Select...</option><option value="No">No</option><option value="Yes">Yes</option></select></td></tr>
        <tr><td>Spleen Size (cm)</td><td><input type="text" id="spleenSize"></td></tr>
        <tr><td>Liver Visualisation</td><td><select id="liverVis" onchange="updateManagement()"><option value="">Select...</option><option value="VIS-A">VIS-A</option><option value="VIS-B">VIS-B</option><option value="VIS-C">VIS-C</option></select></td></tr>
        <tr пропону><td>Liver Lesion(s)</td><td><select id="liverLesion" onchange="updateManagement()"><option value="">Select...</option><option value="US-1">US-1 (Negative)</option><option value="US-2">US-2 (Subthreshold)</option><option value="US-3">US-3 (Positive)</option></select></td></tr>
        <tr style="background:#fff2f0;"><td>Management Recommendation<br><small>(per LI-RADS v2024)</small></td><td id="managementOutput">Please select Liver Visualisation and Liver Lesion(s) above.</td></tr>
    </table>
    <div class="copyright">© 2025 Graham Martin</div>
</div>
<script>
function resetForm(){
    document.querySelectorAll("input,select").forEach(e=>e.value="");
    updateManagement();
}
function updateManagement(){
    const vis = document.getElementById("liverVis").value;
    const lesion = document.getElementById("liverLesion").value;
    let baseText = "";
    let noteText = "";

    if (!vis || !lesion) {
        baseText = "Please select Liver Visualisation and Liver Lesion(s) above.";
    }
    else if (lesion === "US-3") {
        baseText = "US-3 (Positive) → Observation(s) detected that may warrant multiphase contrast enhanced imaging.";
    }
    else if (lesion === "US-2" && vis === "VIS-A") {
        baseText = "US-2 (Subthreshold) with VIS-A → Repeat ultrasound in 3–6 months.";
    }
    else if (lesion === "US-2" && vis === "VIS-B") {
        baseText = "US-2 (Subthreshold) with VIS-B → Two short-interval follow-up ultrasounds at 3–6 month intervals, then return to routine 6-monthly surveillance if stable.";
    }
    else if (lesion === "US-2" && vis === "VIS-C") {
        baseText = "US-2 (Subthreshold) with VIS-C → Repeat ultrasound within 3 months or consider alternative imaging (CT/MRI) due to severe visualisation limitations.";
    }
    else if (lesion === "US-1" && vis === "VIS-A") {
        baseText = "US-1 (Negative) with VIS-A → Continue routine 6-monthly ultrasound surveillance.";
    }
    else if (lesion === "US-1" && vis === "VIS-B") {
        baseText = "US-1 (Negative) with VIS-B → Continue routine 6-monthly ultrasound surveillance (moderate visualisation limitations noted).";
    }
    else if (lesion === "US-1" && vis === "VIS-C") {
        baseText = "US-1 (Negative) with VIS-C → Consider switching to alternative imaging (multiphase CT or MRI) every 6 months due to severe visualisation limitations.";
    }

    // Only italicise explanatory part after "surveillance" in US-1 cases
    if (lesion === "US-1" && baseText.includes("surveillance")) {
        let parts = baseText.split("surveillance");
        baseText = parts[0] + "surveillance" + "<em>" + parts.slice(1).join("surveillance") + "</em>";
    }

    noteText = "<br><br><em>Note: If serum AFP is elevated (above local reference level), proceed to multiphase CT or MRI irrespective of ultrasound category.</em>";
    document.getElementById("managementOutput").innerHTML = baseText + noteText;
}
function copyReport(){
    const fields=[
        {id:"date",label:"Date of Previous USS"},
        {id:"liverDesc",label:"Liver Parenchymal Description"},
        {id:"portalVein",label:"Portal Vein Patent"},
        {id:"pvVelocity",label:"PV Velocity (cm/s)"},
        {id:"hepaticVeins",label:"Hepatic Veins Patent"},
        {id:"paraUmbilical",label:"Recanalisation of Para-Umbilical Vein"},
        {id:"spleenSize",label:"Spleen Size (cm)"},
        {id:"liverVis",label:"Liver Visualisation"},
        {id:"liverLesion",label:"Liver Lesion(s)"}
    ];
    let r="LI-RADS Ultrasound Surveillance Report\n\n";
    fields.forEach(f=>{
        const el=document.getElementById(f.id);
        const val=el.options?el.options[el.selectedIndex].text:(el.value||"Not specified");
        r+=`${f.label}: ${val}\n`;
    });
    let cleanManagement = document.getElementById("managementOutput").innerText;
    r+="\nManagement Recommendation (per LI-RADS v2024):\n"+cleanManagement;
    navigator.clipboard.writeText(r).then(()=>alert("Report copied to clipboard!"));
}
</script>
</body>
</html>
